name: Deploy Docker Compose

on:
  workflow_call:
    inputs:
      environment:
        required: true
        type: string
      image-tag:
        default: "latest"
        type: string
        description: "The tag for the docker images (Default: latest)"

jobs:
  deploy:
    # TODO: uses: ls1intum/.github/.github/workflows/deploy-docker-compose.yml@main
    uses: ./.github/workflows/deploy-docker-compose-shared.yml
    with:
      environment: ${{ inputs.environment }}
      docker-compose-file: "./docker-compose.prod.yml"
      image-tag: ${{ inputs.image-tag }}
      env-vars: |
        DEPLOYMENT_URL=${{ vars.DEPLOYMENT_URL }}
        APOLLON_REDIS_DIAGRAM_TTL=${{ vars.APOLLON_REDIS_DIAGRAM_TTL }}
    secrets: inherit
